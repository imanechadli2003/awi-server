generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}



model JeuxMarque {
  JeuRef_id Int     @id
  Nom       String
  Editeur   String
  jeuxDepot Jeu[]   @relation("JeuxMarque_Jeu")
}

model Jeu {
  JeuID         Int         @id
  JeuRef_id     Int
  depot_ID      Int
  prix_unitaire Float
  mise_en_vente Boolean
  depot         Depot       @relation(fields: [depot_ID], references: [ID_depot])
  jeuxMarque    JeuxMarque? @relation("JeuxMarque_Jeu", fields: [JeuRef_id], references: [JeuRef_id])
  achat_jeux    AchatJeu[]
  depot_jeux    DepotJeu[]
}

model Depot {
  ID_depot              Int        @id
  VendeurID             Int
  date_depot            DateTime
  id_session            Int
  comission_depot_total Float
  vendeur               Vendeur    @relation(fields: [VendeurID], references: [VendeurID])
  session               Session    @relation(fields: [id_session], references: [idSession])
  jeux                  Jeu[]
  depot_jeux            DepotJeu[]
}

model Vendeur {
  VendeurID Int     @id
  Nom       String
  Email     String
  Telephone String
  Balance   Float
  depots    Depot[]

  BilanVendeurSession BilanVendeurSession[]
}

model DepotJeu {
  depot_ID        Int
  JeuID           Int
  quantite_depose Int
  comission_depot Float
  depot           Depot @relation(fields: [depot_ID], references: [ID_depot])
  jeu             Jeu   @relation(fields: [JeuID], references: [JeuID])

  @@id([depot_ID, JeuID])
}

model Achat {
  AchatID               Int         @id
  Total_paye            Float
  id_session            Int
  DateAchat             DateTime
  comission_vente_total Float
  session               Session     @relation(fields: [id_session], references: [idSession])
  acheteur              Acheteur    @relation(fields: [ID_Acheteur], references: [AcheteurID])
  ID_Acheteur           Int
  achat_jeux            AchatJeu[]
}

model AchatJeu {
  AchatID           Int
  JeuID             Int
  comission_vente   Float
  quantite_achete   Int
  achat             Achat @relation(fields: [AchatID], references: [AchatID])
  jeu               Jeu   @relation(fields: [JeuID], references: [JeuID])

  @@id([AchatID, JeuID])
}

model Acheteur {
  AcheteurID Int      @id
  Nom        String
  Prenom     String
  Email      String
  Telephone  String
  Adresse    String
  achats     Achat[]
}

model Facture {
  id_facture Int   @id
  id_session Int
  ID_Acheteur Int
  session    Session @relation(fields: [id_session], references: [idSession])
}

model Session {
  idSession      Int      @id
  NomSession     String
  DateDebut      DateTime
  DateFin        DateTime?
  pourc_frais_depot Float
  pourc_frais_vente Float
  Statut         Boolean
  achats         Achat[]
  factures       Facture[]
  depots         Depot[]
  bilanVendeurSessions BilanVendeurSession[]
}

model Utilisateur {
  UtilisateurID Int      @id
  Nom           String
  Prenom        String
  Email         String
  MdP           String
  Role          Role
}

enum Role {
  Manager
  Admin
}

model BilanVendeurSession {
  id_vendeur     Int
  id_session     Int
  total_depots   Int
  total_ventes   Int
  total_stocks   Int
  total_gains    Float
  total_comissions Float
  vendeur        Vendeur @relation(fields: [id_vendeur], references: [VendeurID])
  session        Session @relation(fields: [id_session], references: [idSession])

  @@id([id_vendeur, id_session])
}
